<section class="Meal-kits">
    <div class="container">
        <% let currentCategory = ""; %>
        <% allMealKits.forEach(mealKit => { %>
            <% if (mealKit.category !== currentCategory) { %>
                <% if (currentCategory !== "") { %>
                    </div>
                </div>
                <% } %>
                <div class="category-container">
                    <h2 class="categoryName text-center mb-4 display-4"><%= mealKit.category %></h2>
                    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-2 g-4 justify-content-center">
            <% } %>
            <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4 d-flex align-items-stretch">
                <div class="flip-card p-8">
                    <div class="flip-card-inner">
                        <div class="flip-card-front">
                            <img src="<%= mealKit.imageUrl %>" class="card-img-top" alt="<%= mealKit.title %>">
                            <div class="card-body">
                                <h5 class="card-title"><%= mealKit.title %></h5>
                                <p class="price">$<%= mealKit.price.toFixed(2) %></p>
                                <p class="includes"><strong>Includes:</strong> <%= mealKit.includes %></p>
                                <p class="cookingTime"><strong>Cooking Time:</strong> <%= mealKit.cookingTime %> minutes</p>
                                <p class="servings"><strong>Servings:</strong> <%= mealKit.servings %></p>
                            </div>
                        </div>
                        <div class="flip-card-back">
                            <div class="card-body">
                                <p class="card-description"><%= mealKit.description %></p>
                                <p class="category">Category: <%= mealKit.category %></p>
                                <% if (user && role === "customer") { %>
                                    <form action="/cart/add" method="POST">
                                        <input type="hidden" name="mealKitId" value="<%= mealKit._id %>">
                                        <button type="submit" class="btn btn-primary">Buy</button>
                                    </form>
                                <% } %>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
            <% currentCategory = mealKit.category; %>
        <% }); %>
        </div>
    </div>
</section>
